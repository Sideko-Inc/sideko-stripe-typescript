import Stripe, { Environment } from "@sideko-inc/stripe";

describe("tests client.paymentIntent.list", () => {
  test.concurrent(
    "GET /v1/payment_intents | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent.list().asResponse(),
        client.paymentIntent.list(),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.search", () => {
  test.concurrent(
    "GET /v1/payment_intents/search | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent.search({ query: "string" }).asResponse(),
        client.paymentIntent.search({ query: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.get", () => {
  test.concurrent(
    "GET /v1/payment_intents/{intent} | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent.get({ intent: "string" }).asResponse(),
        client.paymentIntent.get({ intent: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.create", () => {
  test.concurrent(
    "POST /v1/payment_intents | testId: success_default | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent
          .create({ amount: 123, currency: "string" })
          .asResponse(),
        client.paymentIntent.create({ amount: 123, currency: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.update", () => {
  test.concurrent(
    "POST /v1/payment_intents/{intent} | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent.update({ intent: "string" }).asResponse(),
        client.paymentIntent.update({ intent: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.applyCustomerBalance", () => {
  test.concurrent(
    "POST /v1/payment_intents/{intent}/apply_customer_balance | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent
          .applyCustomerBalance({ intent: "string" })
          .asResponse(),
        client.paymentIntent.applyCustomerBalance({ intent: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.cancel", () => {
  test.concurrent(
    "POST /v1/payment_intents/{intent}/cancel | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent.cancel({ intent: "string" }).asResponse(),
        client.paymentIntent.cancel({ intent: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.capture", () => {
  test.concurrent(
    "POST /v1/payment_intents/{intent}/capture | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent.capture({ intent: "string" }).asResponse(),
        client.paymentIntent.capture({ intent: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.confirm", () => {
  test.concurrent(
    "POST /v1/payment_intents/{intent}/confirm | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent.confirm({ intent: "string" }).asResponse(),
        client.paymentIntent.confirm({ intent: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.incrementAuthorization", () => {
  test.concurrent(
    "POST /v1/payment_intents/{intent}/increment_authorization | testId: success_default | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent
          .incrementAuthorization({ amount: 123, intent: "string" })
          .asResponse(),
        client.paymentIntent.incrementAuthorization({
          amount: 123,
          intent: "string",
        }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});

describe("tests client.paymentIntent.verifyMicrodeposits", () => {
  test.concurrent(
    "POST /v1/payment_intents/{intent}/verify_microdeposits | testId: generated_success | Success test with response schema validation. Expects status code 200",
    async () => {
      const client = new Stripe({
        token: "API_TOKEN",
        environment: Environment.MockServer,
      });
      // Get both raw response for status and parsed response for data
      const [rawResponse, response] = await Promise.all([
        client.paymentIntent
          .verifyMicrodeposits({ intent: "string" })
          .asResponse(),
        client.paymentIntent.verifyMicrodeposits({ intent: "string" }),
      ]);
      expect(rawResponse.status).toBe(200); // Exact status code match
      // Response body automatically validated by Zod schema during deserialization
      expect(response).toBeDefined();
    },
  );
});
